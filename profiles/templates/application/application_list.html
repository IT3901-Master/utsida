{% extends "utsida/layout.html" %}


{% block content %}
    {% load widget_tweaks %}

    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
                <div class="alert alert-success" role="alert">{{ message|escape|safe }}</div>
            {% elif message.tags == 'error' %}
                <div class="alert alert-danger" role="alert">{{ message|escape|safe }}</div>
            {% endif %}
        {% endfor %}
    {% endif %}

    <div class="row">
        <div class="col-md-10 col-md-offset-1">


            <h2 class="text-center">Mine søknader </h2>

            {% if object_list %}
                {% for application in object_list %}
                    <div class=" panel panel-default boxShadow">
                    {% if application.status == "A" %}
                        <div class="panel-heading" style="background-color: #dff0d8">
                    {% elif application.status == "P" %}
                        <div class="panel-heading" style="background-color: #fcf8e3">
                    {% elif application.status == "D" %}
                        <div class="panel-heading" style="background-color: #f2dede">
                    {% endif %}
                <div class="row">
                    <div class="col-md-2">
                        {% if application.status == "A" %}
                            Godkjent
                        {% elif application.status == "P" %}
                            Til godkjenning
                        {% elif application.status == "D" %}
                            Ikke godkjent
                        {% endif %}
                    </div>
                    <div class="col-md-8 panel-title text-center">
                        {{ application.course_matches.all.0.abroadCourse.university }}
                    </div>
                    <div class="col-md-2">
                        <div class="col-md-4 col-md-offset-4" id="editContainer">
                        <span id="editApplication" class="glyphicon glyphicon-edit pointer large-glyph"
                              onclick=location.href="{% url 'edit_application' id=application.id %}"></span>
                        </div>
                        <div class="col-md-4" id="removeContainer">
                        <span class="glyphicon glyphicon-trash pointer large-glyph" data-toggle="confirmation"
                              data-id="{{ application.id }}"></span>
                        </div>
                    </div>
                </div>
                </div>
                <div class="panel-body">
                    {% if application.course_matches %}
                        <table class="table">
                            <thead>
                            <th>NTNU</th>
                            <th>{{ application.course_matches.all.0.abroadCourse.university.name }}</th>
                            </thead>
                            <tbody id="courseMatchList">
                            {% for course in application.course_matches.all %}
                                <tr>
                                <td><a href="https://www.ntnu.no/studier/emner/{{ course.homeCourse.code }}"
                                       target="_blank"
                                       onclick="return alertLink(this)"> {{ course.homeCourse.code }} {{ course.homeCourse.name }} </a>
                                </td>
                                {% if course.abroadCourse.description_url %}
                                    <td>
                                        <a href="{{ course.abroadCourse.description_url }}" target="_blank"
                                           onclick="return alertLink(this)">{{ course.abroadCourse.code }} {{ course.abroadCourse.name }}</a>
                                    </td>
                                {% else %}
                                    <td> {{ course.abroadCourse.code }} {{ course.abroadCourse.name }}</td>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <div>Det er ingen fag-koblinger i denne søknaden</div>
                    {% endif %}
                    <label>Kommentar</label>
                    {% if application.comment and application.comment.strip %}
                        <div> {{ application.comment }}</div>
                    {% else %}
                        <div class="italic"> (tom)</div>
                    {% endif %}
                </div>
                </div>
                {% endfor %}
            {% else %}
                <div>Du har ingen søknader</div>
            {% endif %}


            </div>
            </div>

            {% load staticfiles %}
            <script src="{% static 'utsida/javascripts/profile/applicationHandler.js' %}"></script>

{% endblock %}