{% extends 'utsida/layout.html' %}

{% block content %}
    {% load result_extras %}

    <div id="selectedCourseContainer" class="panel panel-primary square-corners boxShadow selectedCourseContainer">
        <div class="panel-heading square-corners">
            Dine valgte fag
            <span class="badge" id="numSelectedCoursesBadge"></span>
            <span id="selectedCourseToggleBtn" onclick="toggleSelectedCourses()" class="pull-right glyphicon glyphicon-chevron-up"></span>
        </div>
        <div id="selectedCourseBody" class="panel-body" style="display: none">
            <ul id="selectedCourseList"></ul>
        </div>
        <div id="selectedCourseFooter" class="panel-footer" style="display: none">
            <button class="btn btn-success pull-right">Send til veileder <span class="glyphicon glyphicon-chevron-right"></span></button>
            <button onclick="removeAllSelectedCourses()" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span> Tøm listen</button>
            <button class="btn btn-default"><span class="glyphicon glyphicon-ok"></span> Lagre fag</button>
        </div>
    </div>


    {% if show_loader %}
    <div id="loadingScreen" class="loadScreen">
        <div class="row">
            <div id="searchParameters" class="col-md-6 col-md-offset-3">
                <h2 class="text-center">Søker etter turer som likner på din</h2>
                <div class="well vertical-space-top">
                    <ul>
                        <li>Institutt hjemme: <span id="institute" style="font-weight: bold">{{ user.profile.institute }}</span></li>
                        <li>Verdensdel: <span id="continent" style="font-weight: bold">{{ form.data.continent }}</span></li>
                        <li>Land: <span id="country" style="font-weight: bold">{{ form.data.country }}</span></li>
                        <li>Universitet: <span id="university" style="font-weight: bold">{{ form.data.university }}</span></li>
                        <li>Studiespråk: <span id="language" style="font-weight: bold">{{ form.data.language }}</span></li>
                        <li>Studieår: <span id="studyPeriod" style="font-weight: bold">{{ form.data.studyPeriod }}</span></li>
                        <li>Akademisk kvalitet: <span id="academicQuality" style="font-weight: bold">{{ form.data.academicQualityRating }}</span></li>
                        <li>Sosial kvalitet: <span id="socialQuality" style="font-weight: bold">{{ form.data.socialQualityRating }}</span></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <img id="loader" src="../../static/utsida/images/loading.gif" style="width:20%; display: block; margin: auto">
        </div>

    </div>
    {% endif %}

    <div id="filters" class="row vertical-space-bottom-big">
        <h2 class="text-center">Her er turene som likner mest på din situasjon.</h2>
        <h3 class="subTitle text-center vertical-space-bottom-big">(Trykk på knappene under for å filtrere på universitet, og legg til fag du ønsker å ta ved å trykke på de)</h3>

        <div class="col-md-6 col-md-offset-3">
            <a href="/process/result/all"><button class="btn btn-default vertical-space-bottom-small">All</button></a>
            {% for university in universities %}
                <a href="/process/result/{{ university }}"><button class="btn btn-default vertical-space-bottom-small">{{ university }}</button></a>
            {% endfor %}
        </div>
    </div>

    <div id="results" class="row vertical-space-top-big">

        {% for case in similar_cases %}
            {% if forloop.counter|divisibleby:3 %}<div class="row">{% endif %}
            <div class="col-md-4">
                <div class="panel panel-primary square-corners boxShadow">
                    <div class="panel-heading square-corners">
                        {{ case.University }} ({{ case.Country }}) <span class="pull-right badge">{{ case.Similarity }}</span>
                    </div>
                    <div class="panel-body">
                        <div class="subjectsContainer">
                            {% for subject in case.Subjects %}
                                {% if subject in matches.keys %}
                                    <!--<div onclick="addCourse(this.innerHTML)" class="label label-success pointer noSelect">{{ subject }} - {{matches | get:subject}}</div>-->
                                    <div onclick="courseSelector().addCourse(this.innerHTML)" class="btn btn-success courseBtn">{{ subject }}</div>

                                {% else %}
                                    <!--<div onclick="addCourse(this.innerHTML)" style="margin-right: 5px" class="label label-warning pointer noSelect">{{ subject }}</div>-->
                                    <div onclick="addCourse(this.innerHTML)" class="btn btn-warning courseBtn">{{ subject }}</div>
                                {% endif %}
                            {% endfor %}
                        </div>

                        <hr>

                        <div class="hiddenInformation">
                            <div>
                                <p><span class="bold">Institutt hjemme:</span> {{ case.Institute }}</p>
                                <p><span class="bold">Verdensdel:</span> {{ case.Continent }}</p>
                                <p><span class="bold">Land:</span> {{ case.Country }}</p>
                                <p><span class="bold">Studiespråk:</span> {{ case.Language }}</p>
                                <p><span class="bold">Studieperiode:</span> {{ case.StudyPeriod }}</p>
                                <p><span class="bold">Vurdering av akademisk kvalitet:</span> {{ case.AcademicQuality }}</p>
                                <p><span class="bold">Vurdering av sosial kvalitet:</span> {{ case.SocialQuality}}</p>
                            </div>
                        </div>
                        <div class="text-center">
                            <span id="expandTripChevron" style="color: #337ab7; cursor: pointer;" class="accordion glyphicon glyphicon-chevron-down"></span>
                        </div>
                    </div>
                </div>
            </div>
            {% if forloop.counter|divisibleby:3 %}</div>{% endif %}
        {% endfor %}
    </div>

    {% load staticfiles %}
    <script src="{% static 'utsida/javascripts/result/showHiddenContent.js' %}"></script>
    <script src="{% static 'utsida/javascripts/result/loadingScreen.js' %}"></script>
    <script src="{% static 'utsida/javascripts/result/highlightCurrentUniversity.js' %}"></script>
    <script src="{% static 'utsida/javascripts/result/courseSelector.js' %}"></script>


{% endblock %}

